<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
	<head>
		<%- include('../partials/head'); %>
		<!-- END Three.js Load -->
	</head>
	<body class="vertical-layout vertical-menu 2-columns   menu-expanded fixed-navbar" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-purple-blue" data-col="2-columns">
		<!-- fixed-top-->
		<%- include('../partials/header'); %>
		<!-- ////////////////////////////////////////////////////////////////////////////-->
		<%- include('../partials/sidebar'); %>
		
		<!-- dashboard -->
		<div class="app-content content">
			<div class="content-wrapper">
				<div class="content-wrapper-before"></div>
				<div class="content-header row">
					<div class="content-header-left col-md-4 col-12 mb-2">
						<h3 class="content-header-title">Owl Eye Viewer</h3>
					</div>
					<div class="content-header-right col-md-8 col-12">
						<div class="breadcrumbs-top float-md-right">
							<div class="breadcrumb-wrapper mr-1">
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a href="/">Home</a>
									</li>
									<li class="breadcrumb-item active">Import
									</li>
								</ol>
							</div>
						</div>
					</div>
				</div>
				
				<div class="content-body">
					<section id="basic-buttons">
					<!-- 3d viewer card body start -->
						<div class="row">
							<div class="col-lg-12 col-md-12">
								<div class="card" id="canvas-container">
									<div class="card-header">
										<a class="heading-elements-toggle"><i class="la la-ellipsis font-medium-3"></i></a>
										<div class="heading-elements">
											<ul class="list-inline mb-0">
												<li><a data-action="collapse"><i class="ft-minus"></i></a></li>
												<li><a data-action="reload"><i class="ft-rotate-cw"></i></a></li>
												<li><a data-action="expand"><i class="ft-maximize"></i></a></li>
												<li><a data-action="close"><i class="ft-x"></i></a></li>
											</ul>
										</div>
									</div>
									<div class="card-content collapse show">
										<div class="card-body">
											<!-- <p class="card-subtitle">You can load *.txt, *.obj files from owl windows app.</p> -->
											<div class="row" style="padding: 0 20px;">
												<form action="/database/upload" target="hiddenitem" method="post" enctype="multipart/form-data" id="uploadform">
													<div class="custom-file mb-3">
														<input type="file" class="custom-file-input" id="customFile" name="file" accept=".json, .csv">
														<label class="custom-file-label" for="customFile">Choose file</label>
													</div>
												</form>
												<iframe style="display: none;" name="hiddenitem" id="ifr"></iframe>
											</div>
											<div class="row">
												<div class="col-lg-5 col-md-5 col-sm-5">
													<div class="form-group bmd-form-group">
														<label for="dbname" class="bmd-label-floating">DB</label>
														<input type="text" class="form-control" id="dbname">
														<span class="bmd-help">Input DB name.</span>
													  </div>
												</div>
												<div class="col-lg-4 col-md-4 col-sm-4">
													<div class="form-group bmd-form-group">
														<label for="collectionname" class="bmd-label-floating">Collection</label>
														<input type="text" class="form-control" id="collectionname">
														<span class="bmd-help">Input Collection name.</span>
													  </div>
												</div>
												<div class="col-lg-3 col-md-3 col-sm-3" style="display: flex;">
													<button type="button" class="btn btn-info btn-min-width" onclick="importdatabase()" style="margin: auto;"><i class="ft-upload"></i> Import</button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</section>
				</div>


			</div>
		</div>
<!-- ////////////////////////////////////////////////////////////////////////////-->

<!-- page content end -->
<%- include('../partials/footer'); %>
<script>
	$(".custom-file-input").on("change", function() {
		var fileName = $(this).val().split("\\").pop();
		$(this).siblings(".custom-file-label").addClass("selected").html(fileName);
		$('#uploadform').submit();
	});
	var importdatabase = () =>{
		let filename = $('label.custom-file-label').html();
		let dbname = $('#dbname').val();
		let collectionname = $('#collectionname').val();
		$.post('/database/importdb',{filename:filename,dbname:dbname,collectionname:collectionname},function(response){
			alert(response);
			if(response === 'Import Successfully')
				$.toast({
					heading: 'Success',
					text: response,
					showHideTransition: 'slide',
					icon: 'success',
					hideAfter: 1500   // in milli seconds
				});
			else															
				$.toast({
					heading: 'Error',
					text: response,
					showHideTransition: 'fade',
					icon: 'error',
					hideAfter: 1500   // in milli seconds
				});
		});
	}
</script>
</body>
</html>